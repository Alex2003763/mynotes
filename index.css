/* 響應式 AI 按鈕網格樣式 */
.ai-button-grid {
  display: grid;
  gap: 0.5rem; /* gap-2 */
  grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
  
  /* 當容器寬度小於 300px 時，使用單列布局 */
  @container (max-width: 300px) {
    grid-template-columns: 1fr;
  }
  
  /* 當容器寬度在 300px-400px 之間時，優化為更緊湊的佈局 */
  @container (min-width: 300px) and (max-width: 400px) {
    grid-template-columns: repeat(2, 1fr);
    gap: 0.375rem; /* gap-1.5 */
  }
  
  /* 當容器寬度大於 400px 時，使用標準佈局 */
  @container (min-width: 400px) {
    grid-template-columns: repeat(2, 1fr);
    gap: 0.5rem; /* gap-2 */
  }
}

.ai-button-item {
  display: flex;
  align-items: stretch;
}

.ai-button-item button {
  width: 100%;
  flex: 1;
}

/* 預覽操作按鈕區域 */
.ai-preview-actions {
  display: flex;
  flex-wrap: wrap;
  gap: 0.5rem; /* gap-2 */
  justify-content: flex-end;
  
  /* 小屏幕下的響應式調整 */
  @media (max-width: 640px) {
    justify-content: stretch;
    gap: 0.375rem; /* gap-1.5 */
  }
}

.ai-preview-actions button {
  /* 在小屏幕下，讓按鈕平均分配空間 */
  @media (max-width: 640px) {
    flex: 1;
    min-width: 0; /* 允許按鈕縮小 */
  }
  
  /* 在極小屏幕下，讓按鈕更緊湊 */
  @media (max-width: 480px) {
    padding-left: 0.375rem; /* px-1.5 */
    padding-right: 0.375rem; /* px-1.5 */
    font-size: 0.75rem; /* text-xs */
  }
}

/* 基於側邊欄寬度的容器查詢樣式 */
.right-sidebar-container {
  container-type: inline-size;
  container-name: sidebar;
}

/* 當側邊欄寬度小於 250px 時的樣式 */
@container sidebar (max-width: 250px) {
  .ai-button-grid {
    grid-template-columns: 1fr;
    gap: 0.25rem; /* gap-1 */
  }
  
  .ai-button-item button {
    padding: 0.375rem; /* p-1.5 */
    font-size: 0.75rem; /* text-xs */
    min-height: 2rem; /* min-h-8 */
  }
  
  .ai-button-item button span {
    display: none; /* 隱藏文字，只顯示圖標 */
  }
  
  .ai-preview-actions {
    flex-direction: column;
    gap: 0.25rem; /* gap-1 */
  }
  
  .ai-preview-actions button span {
    display: none; /* 隱藏文字，只顯示圖標 */
  }
}

/* 當側邊欄寬度在 250px-350px 之間時的樣式 */
@container sidebar (min-width: 250px) and (max-width: 350px) {
  .ai-button-grid {
    grid-template-columns: repeat(2, 1fr);
    gap: 0.375rem; /* gap-1.5 */
  }
  
  .ai-button-item button {
    padding: 0.5rem 0.375rem; /* py-2 px-1.5 */
    font-size: 0.75rem; /* text-xs */
  }
  
  .ai-preview-actions {
    gap: 0.375rem; /* gap-1.5 */
  }
  
  .ai-preview-actions button {
    font-size: 0.75rem; /* text-xs */
    padding: 0.375rem 0.5rem; /* py-1.5 px-2 */
  }
}

/* 優化文字截斷 */
.ai-button-item button span,
.ai-preview-actions button span {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  max-width: 100%;
}

/* 確保圖標始終可見 */
.ai-button-item button svg,
.ai-preview-actions button svg {
  flex-shrink: 0;
}

/* 響應式標題和快捷鍵提示 */
@container sidebar (max-width: 300px) {
  .ai-panel-header h4 {
    font-size: 0.75rem; /* text-xs */
  }
  
  .ai-panel-shortcuts {
    display: none;
  }
}

/* 工具提示在小屏幕下的優化 */
@media (max-width: 640px) {
  [title] {
    position: relative;
  }
}

/* 輸入框響應式樣式 - 當空間不足時允許換行 */
.ai-input-container {
  display: flex;
  flex-direction: row;
  flex-wrap: wrap; /* 允許換行 */
  gap: 0.5rem; /* gap-2 */
  align-items: stretch; /* 恢復對齊方式 */
}

.ai-input-container input {
  flex: 1 1 auto; /* 允許彈性增長和收縮 */
  min-width: 80px; /* 進一步減少最小寬度 */
  max-width: 100%; /* 確保不會超出容器 */
}

.ai-input-container button {
  flex: 0 0 auto; /* 不允許增長和收縮 */
  white-space: nowrap; /* 防止按鈕文字換行 */
  width: auto; /* 讓按鈕使用自然寬度 */
}

/* 強制在較寬的情況下就開始換行 */
@container sidebar (max-width: 400px) {
  .ai-input-container input {
    flex-basis: 100%; /* 強制輸入框佔滿第一行 */
    min-width: 0; /* 移除最小寬度限制 */
  }
  
  .ai-input-container button {
    flex-basis: 100%; /* 強制按鈕換到第二行 */
    margin-top: 0; /* 確保沒有額外邊距 */
  }
}

/* 當側邊欄寬度較小時，強制垂直排列 */
@container sidebar (max-width: 350px) {
  .ai-input-container {
    flex-direction: column; /* 改為垂直排列 */
    align-items: stretch; /* 讓元素撐滿寬度 */
    gap: 0.375rem; /* gap-1.5 */
  }
  
  .ai-input-container input {
    min-width: unset; /* 移除最小寬度限制 */
    width: 100%; /* 確保輸入框佔滿寬度 */
  }
  
  .ai-input-container button {
    width: 100%; /* 按鈕也佔滿寬度 */
    justify-content: center; /* 按鈕內容居中 */
  }
}

/* 對於更小的寬度，進一步優化 */
@container sidebar (max-width: 280px) {
  .ai-input-container input {
    font-size: 0.75rem; /* text-xs */
    padding: 0.375rem; /* p-1.5 */
  }
  
  .ai-input-container button {
    padding: 0.5rem; /* p-2 */
    font-size: 0.75rem; /* text-xs */
  }
}

/* 在極小寬度下，只顯示圖標 */
@container sidebar (max-width: 250px) {
  .ai-input-container input {
    font-size: 0.75rem; /* text-xs */
    padding: 0.375rem; /* p-1.5 */
  }
  
  .ai-input-container button {
    padding: 0.375rem; /* p-1.5 */
    min-height: 2rem; /* min-h-8 */
    min-width: 2rem; /* 確保按鈕最小寬度 */
  }
  
  .ai-input-container button span {
    display: none; /* 隱藏按鈕文字 */
  }
}

/* 在中等寬度下，調整字體大小但保持布局 */
@container sidebar (min-width: 250px) and (max-width: 350px) {
  .ai-input-container input {
    font-size: 0.75rem; /* text-xs */
  }
  
  .ai-input-container button {
    font-size: 0.75rem; /* text-xs */
    padding: 0.5rem 0.75rem; /* py-2 px-3 */
  }
}

/* 預覽區域響應式樣式 */
.ai-preview-container {
  /* 預覽區域的基本樣式已在組件中定義 */
}

/* AI 生成內容狀態區域樣式 */
.ai-status-section {
  display: flex;
  align-items: center;
  justify-content: space-between;
  margin-bottom: 0.5rem; /* mb-2 */
  gap: 0.5rem; /* gap-2 */
  padding: 0.75rem; /* p-3 */
  border: 1px solid rgb(34 197 94 / 0.3); /* border-green-500/30 */
  border-radius: 0.5rem; /* rounded-lg */
  background-color: rgb(240 253 244); /* bg-green-50 */
}

.dark .ai-status-section {
  border-color: rgb(34 197 94 / 0.3); /* dark:border-green-400/30 */
  background-color: rgb(20 83 45 / 0.2); /* dark:bg-green-900/20 */
}

.ai-status-header {
  font-size: 0.875rem; /* text-sm */
  font-weight: 600; /* font-semibold */
  color: rgb(21 128 61); /* text-green-700 */
}

.dark .ai-status-header {
  color: rgb(134 239 172); /* dark:text-green-300 */
}

.ai-status-indicator {
  font-size: 0.75rem; /* text-xs */
  color: rgb(22 163 74); /* text-green-600 */
}

.dark .ai-status-indicator {
  color: rgb(74 222 128); /* dark:text-green-400 */
}

@container sidebar (max-width: 300px) {
  .ai-preview-container textarea {
    height: 120px; /* 在小屏幕下減少高度 */
    font-size: 0.75rem; /* text-xs */
    padding: 0.375rem; /* p-1.5 */
  }
  
  .ai-preview-container h4 {
    font-size: 0.75rem; /* text-xs */
  }
  
  .ai-status-section {
    padding: 0.5rem; /* p-2 */
    gap: 0.25rem; /* gap-1 */
  }
  
  .ai-status-header {
    font-size: 0.75rem; /* text-xs */
  }
  
  .ai-status-indicator {
    font-size: 0.625rem; /* text-xs reduced */
  }
}

/* 動畫優化 */
@media (prefers-reduced-motion: reduce) {
  .ai-button-grid,
  .ai-preview-actions {
    transition: none;
  }
}

/* 深色模式下的額外調整 */
.dark .ai-button-grid,
.dark .ai-preview-actions {
  /* 深色模式下的樣式調整已在組件中通過 Tailwind 類處理 */
}

/* 輔助功能增強 */
@media (forced-colors: active) {
  .ai-button-item button,
  .ai-preview-actions button {
    border: 1px solid ButtonBorder;
  }
  
  .ai-button-item button:focus,
  .ai-preview-actions button:focus {
    outline: 2px solid Highlight;
    outline-offset: 2px;
  }
}

/* 高對比度支持 */
@media (prefers-contrast: high) {
  .ai-button-item button,
  .ai-preview-actions button {
    border-width: 2px;
  }
}

/* =================== 筆記網格佈局樣式 =================== */

/* 主容器 */
.note-grid-container {
  display: flex;
  flex-direction: column;
  height: 100%;
  padding: 1rem;
  gap: 1.5rem;
}

/* 標題區域 */
.note-grid-header {
  display: flex;
  flex-direction: column;
  gap: 1rem;
  padding-bottom: 1rem;
  border-bottom: 1px solid rgb(226 232 240);
}

.dark .note-grid-header {
  border-bottom-color: rgb(71 85 105);
}

/* 篩選面板 */
.note-grid-filters {
  animation: slideDown 0.2s ease-out;
}

@keyframes slideDown {
  from {
    opacity: 0;
    transform: translateY(-10px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

/* 空狀態 */
.note-grid-empty {
  display: flex;
  align-items: center;
  justify-content: center;
  min-height: 400px;
  padding: 2rem;
}

/* 網格佈局 */
.note-grid {
  display: grid;
  gap: 1.5rem;
  padding-bottom: 2rem; /* 保持底部間距，以便滾動到底部時內容不被遮擋 */
  overflow-y: auto; /* 添加垂直滾動 */
  flex: 1; /* 讓它佔用剩餘空間 */
  min-height: 0; /* 修復 flexbox 在某些情況下的問題 */
}

/* 網格視圖 - 響應式網格 */
.note-grid-grid {
  grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
}

/* 列表視圖 - 單列 */
.note-grid-list {
  grid-template-columns: 1fr;
  justify-items: center; /* Center items horizontally */
  gap: 1rem;
}

/* 緊湊視圖 - 更小的間距 */
.note-grid-compact {
  grid-template-columns: 1fr;
  justify-items: center; /* Center items horizontally */
  gap: 0.5rem;
}

/* 響應式斷點 */
@media (max-width: 640px) {
  .note-grid-container {
    padding: 0.75rem;
    gap: 1rem;
  }
  
  .note-grid-grid {
    grid-template-columns: 1fr;
    gap: 1rem;
  }
  
  .note-grid {
    gap: 1rem;
  }
}

@media (min-width: 1024px) {
  .note-grid-grid {
    grid-template-columns: repeat(auto-fill, minmax(320px, 1fr));
  }
}

@media (min-width: 1440px) {
  .note-grid-grid {
    grid-template-columns: repeat(auto-fill, minmax(340px, 1fr));
    gap: 2rem;
  }
}

@media (min-width: 1920px) {
  .note-grid-grid {
    grid-template-columns: repeat(auto-fill, minmax(360px, 1fr));
    gap: 2.5rem;
  }
}

/* =================== 筆記卡片樣式 =================== */

/* 文字截斷 */
.line-clamp-2 {
  display: -webkit-box;
  -webkit-line-clamp: 2;
  -webkit-box-orient: vertical;
  overflow: hidden;
}

.line-clamp-3 {
  display: -webkit-box;
  -webkit-line-clamp: 3;
  -webkit-box-orient: vertical;
  overflow: hidden;
}

/* 卡片懸停效果 */
.note-card-hover {
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
}

.note-card-hover:hover {
  transform: translateY(-4px) scale(1.02);
  box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
}

.dark .note-card-hover:hover {
  box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.25), 0 10px 10px -5px rgba(0, 0, 0, 0.1);
}

/* 標籤動畫 */
.tag-hover {
  transition: all 0.2s ease-in-out;
}

.tag-hover:hover {
  transform: scale(1.05);
  filter: brightness(1.1);
}

/* 按鈕動畫 */
.btn-scale {
  transition: transform 0.15s ease-in-out;
}

.btn-scale:hover {
  transform: scale(1.05);
}

.btn-scale:active {
  transform: scale(0.95);
}

/* 載入動畫 */
.loading-skeleton {
  background: linear-gradient(90deg, #f0f0f0 25%, #e0e0e0 50%, #f0f0f0 75%);
  background-size: 200% 100%;
  animation: loading 1.5s infinite;
}

.dark .loading-skeleton {
  background: linear-gradient(90deg, #374151 25%, #4b5563 50%, #374151 75%);
  background-size: 200% 100%;
}

@keyframes loading {
  0% {
    background-position: 200% 0;
  }
  100% {
    background-position: -200% 0;
  }
}

/* 脈衝動畫 */
.pulse {
  animation: pulse 2s cubic-bezier(0.4, 0, 0.6, 1) infinite;
}

@keyframes pulse {
  0%, 100% {
    opacity: 1;
  }
  50% {
    opacity: 0.5;
  }
}

/* 淡入動畫 */
.fade-in {
  animation: fadeIn 0.3s ease-in-out;
}

@keyframes fadeIn {
  from {
    opacity: 0;
    transform: translateY(10px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

/* 彈跳動畫 */
.bounce-in {
  animation: bounceIn 0.6s cubic-bezier(0.68, -0.55, 0.265, 1.55);
}

@keyframes bounceIn {
  0% {
    transform: scale(0.3);
    opacity: 0;
  }
  50% {
    transform: scale(1.05);
  }
  70% {
    transform: scale(0.9);
  }
  100% {
    transform: scale(1);
    opacity: 1;
  }
}

/* 滑動效果 */
.slide-up {
  animation: slideUp 0.3s ease-out;
}

@keyframes slideUp {
  from {
    opacity: 0;
    transform: translateY(20px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

/* 旋轉載入動畫 */
.spin {
  animation: spin 1s linear infinite;
}

@keyframes spin {
  from {
    transform: rotate(0deg);
  }
  to {
    transform: rotate(360deg);
  }
}

/* 輔助功能增強 */
@media (prefers-reduced-motion: reduce) {
  .note-card-hover,
  .tag-hover,
  .btn-scale,
  .fade-in,
  .bounce-in,
  .slide-up {
    animation: none;
    transition: none;
  }
  
  .note-card-hover:hover {
    transform: none;
  }
  
  .tag-hover:hover,
  .btn-scale:hover {
    transform: none;
  }
}

/* 高對比度模式支持 */
@media (prefers-contrast: high) {
  .note-grid-header {
    border-bottom-width: 2px;
  }
}

/* 觸摸裝置優化 */
@media (hover: none) and (pointer: coarse) {
  .note-card-hover:hover {
    transform: none;
    box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
  }
  
  .tag-hover:hover,
  .btn-scale:hover {
    transform: none;
  }
  
  /* 增加觸摸目標大小 */
  .note-grid button {
    min-height: 44px;
    min-width: 44px;
  }
}

/* 2K 屏幕優化 */
@media (min-width: 2560px) {
  .note-grid-grid {
    grid-template-columns: repeat(auto-fill, minmax(380px, 1fr));
    gap: 2.5rem;
  }
}

/* 打印樣式 */
@media print {
  .note-grid-header button,
  .note-grid button {
    display: none;
  }
  
  .note-grid {
    gap: 1rem;
  }
  
  .note-card-hover {
    box-shadow: none;
    border: 1px solid #ccc;
  }
}